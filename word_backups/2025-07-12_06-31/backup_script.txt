from datetime import datetime
from pathlib import Path
import shutil

# ✅ Create timestamped folder
timestamp = datetime.now().strftime("%Y-%m-%d_%H-%M")
backup_dir = Path("word_backups") / timestamp
backup_dir.mkdir(parents=True, exist_ok=True)

# ✅ 1. Backup all HTML files in 'templates/'
template_dir = Path("templates")
for html_file in template_dir.glob("*.html"):
    dst_file = backup_dir / f"{html_file.stem}.txt"
    shutil.copy2(html_file, dst_file)
    print(f"✅ Copied: {html_file} → {dst_file}")

# ✅ 2. Backup specific top-level files
top_level_files = [
    ".env", ".env.local", ".gitignore", "backup_script.py", "forms.py",
    "main.py", "migrate.py", "Procfile", "requirements.txt", "wsgi.py",
    "templates/stock_data.html", "templates/trigger_etl.html"  # include missing ones if not globbed above
]

for filename in top_level_files:
    src = Path(filename)
    if src.exists():
        dst_file = backup_dir / f"{src.stem}.txt"
        shutil.copy2(src, dst_file)
        print(f"✅ Copied: {src} → {dst_file}")
    else:
        print(f"⚠️ Skipped (not found): {src}")