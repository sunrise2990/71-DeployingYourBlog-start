{% extends 'base.html' %}
{% block content %}

<div class="container mt-4">

    <!-- ðŸŽ¯ Success Message -->
    <div class="text-center mb-3">
        <h2>Retirement Planner â€“ Savings, Living Expenses, and Investments</h2>
        {% if message %}
            <div class="alert alert-success mt-3">
                ðŸŽ‰ {{ message }}
            </div>
        {% endif %}
    </div>

    <!-- ðŸ“ˆ Graph + ðŸ“Š Table -->
    <div class="row">
        <div class="col-md-8">
            <img src="{{ url_for('static', filename='images/retirement_chart.png') }}" class="img-fluid" alt="Projection Chart">
        </div>
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-primary text-white">Minimum Savings to Retire</div>
                <div class="card-body p-2">
                    <table class="table table-sm table-bordered text-center mb-0">
                        <thead>
                            <tr>
                                <th>Age</th><th>Monthly</th><th>Savings</th><th>Rate</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in savings_table %}
                            <tr>
                                <td>{{ row.age }}</td>
                                <td>${{ row.monthly }}</td>
                                <td>${{ row.savings }}</td>
                                <td>{{ row.rate }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ðŸ’¼ Simulation Box -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card border-dark">
                <div class="card-header bg-info text-white">Legacy Amount Simulation</div>
                <div class="card-body">
                    <p>Legacy Amount for Heirs: <strong>${{ legacy_amount }}</strong></p>
                    <p>Total Assets at Retirement: <strong>${{ total_assets }}</strong></p>
                    <p>Shortfall/Surplus: <strong class="text-danger">${{ delta }}</strong></p>
                </div>
            </div>
        </div>
        <div class="col-md-6 d-flex flex-column justify-content-center align-items-start gap-2">
            <form method="post">
                <button class="btn btn-outline-primary" name="solver" value="1">Solver 1: Adjust Living Expense</button>
                <button class="btn btn-outline-success" name="solver" value="2">Solver 2: Adjust Investment Return</button>
            </form>
        </div>
    </div>

    <!-- ðŸ”§ Input Panel -->
    <form method="POST" action="{{ url_for('retirement') }}">
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header bg-secondary text-white">Input Parameters</div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">Current Age</label>
                                <input type="number" class="form-control" name="current_age" value="{{ inputs.current_age }}">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Retirement Age</label>
                                <input type="number" class="form-control" name="retire_age" value="{{ inputs.retire_age }}">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Monthly Savings</label>
                                <input type="number" class="form-control" name="monthly_savings" value="{{ inputs.monthly_savings }}">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Return Rate (%)</label>
                                <input type="number" class="form-control" step="0.01" name="return_rate" value="{{ inputs.return_rate }}">
                            </div>
                        </div>
                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">Run Retirement Projection</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <!-- ðŸ“‹ Summary Output -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-dark text-white">Summary Output</div>
                <div class="card-body">
                    <ul>
                        <li>Asset Balance at Retirement: <strong>${{ total_assets }}</strong></li>
                        <li>Surplus/Shortfall at Death: <strong>${{ surplus }}</strong></li>
                        <li>Withdrawal Rate Range: {{ withdrawal_rate }}%</li>
                        <li>Asset Depletion Age: {{ depletion_age or 'N/A' }}</li>
                        <li>Legacy Amount: ${{ legacy_amount }}</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div>

{% endblock %}
